name: Auto-build HTML files

on:
  push:
    branches:
      - master
  schedule:
    - cron: '0 8 * * *'  # Runs at 8:00 AM UTC every day

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  prepare-env:
    runs-on: ubuntu-latest
    outputs:
      env_string: ${{ steps.set-env.outputs.env_string }}
    steps:
      - id: set-env
        run: |
          echo "env_string=MY_ENV_VAR1=${{ secrets.MY_ENV_VAR1 }}\nMY_ENV_VAR2=value2" >> $GITHUB_OUTPUT

  call-build-site:
    needs: prepare-env
    uses: comic-git/comic_git_engine/.github/workflows/build_site.yaml@v1
    with:
      env: ${{ needs.prepare-env.outputs.env_string }}
